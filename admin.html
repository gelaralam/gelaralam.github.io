<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard | Kasepuhan Gelaralam</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Playfair+Display:wght@400;700&display=swap"
        rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        :root {
            --admin-primary: #2563eb;
            --admin-bg: #f8fafc;
            --admin-card: #ffffff;
            --admin-text: #1e293b;
        }

        body {
            background-color: var(--admin-bg);
            color: var(--admin-text);
            font-family: 'Inter', sans-serif;
        }

        .admin-header {
            background: #1a1a1a;
            color: white;
            padding: 1.5rem 0;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }

        .admin-container {
            max-width: 1000px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .dashboard-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            margin-bottom: 2rem;
            color: #1a1a1a;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .card {
            background: var(--admin-card);
            border-radius: 12px;
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        input,
        textarea,
        select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        input:focus,
        textarea:focus {
            outline: none;
            border-color: var(--admin-primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .btn-admin {
            background: var(--admin-primary);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-admin:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
        }

        .btn-danger {
            background: #ef4444;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .testimonial-list {
            display: grid;
            gap: 1rem;
        }

        .testimonial-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: #f1f5f9;
            border-radius: 8px;
        }

        .item-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .item-photo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
        }

        .item-text {
            font-size: 0.9rem;
        }

        .item-name {
            font-weight: 700;
        }

        .actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-icon {
            padding: 0.5rem;
            border-radius: 4px;
            background: white;
            color: #64748b;
            border: 1px solid #e2e8f0;
        }

        .btn-icon:hover {
            background: #f8fafc;
            color: var(--admin-primary);
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 2.5rem;
            border-radius: 12px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .output-box {
            background: #1e293b;
            color: #f8fafc;
            padding: 1.5rem;
            border-radius: 8px;
            font-family: monospace;
            white-space: pre-wrap;
            margin-top: 1rem;
            font-size: 0.85rem;
            max-height: 300px;
            overflow-y: auto;
        }

        .badge {
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 700;
            background: #dcfce7;
            color: #166534;
        }
    </style>
</head>

<body>
    <header class="admin-header">
        <div class="container" style="display: flex; justify-content: space-between; align-items: center;">
            <div style="display: flex; align-items: center; gap: 15px;">
                <img src="assets/logo.png" alt="Logo" style="height: 40px;">
                <span style="font-weight: 700; letter-spacing: 1px;">KASEPUHAN GELARALAM</span>
            </div>
            <a href="index.html" class="btn-admin" style="background: transparent; border: 1px solid white;">View
                Website</a>
        </div>
    </header>

    <div class="admin-container">
        <h1 class="dashboard-title"><i class="fa-solid fa-comments"></i> Admin Testimoni</h1>

        <div class="card">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                <h2 style="font-family: 'Playfair Display', serif; margin: 0;">Daftar Testimoni</h2>
                <button class="btn-admin" id="add-btn"><i class="fa-solid fa-plus"></i> Tambah Testimoni</button>
            </div>

            <div class="testimonial-list" id="testimonial-list">
                <!-- Items will be injected here -->
            </div>
        </div>

        <div class="card">
            <h2 style="font-family: 'Playfair Display', serif; margin-bottom: 1rem;">Export Data</h2>
            <p style="font-size: 0.9rem; color: #64748b; margin-bottom: 1.5rem;">
                Gunakan data di bawah ini untuk mengupdate file website secara permanen. Copy kode ini dan masukkan ke
                bagian <code>testimonialData</code> di <code>index.html</code>.
            </p>
            <button class="btn-admin" id="generate-btn"><i class="fa-solid fa-code"></i> Generate Code</button>
            <div id="output-container" style="display: none;">
                <div class="output-box" id="output-code"></div>
                <button class="btn-admin" style="margin-top: 1rem;" id="copy-btn"><i class="fa-solid fa-copy"></i> Copy
                    to Clipboard</button>
            </div>
        </div>
    </div>

    <!-- Modal Form -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <h2 id="modal-title" style="font-family: 'Playfair Display', serif; margin-bottom: 1.5rem;">Tambah Testimoni
            </h2>
            <form id="testimonial-form">
                <input type="hidden" id="edit-index" value="-1">
                <div class="form-group">
                    <label for="name">Nama Lengkap</label>
                    <input type="text" id="name" required placeholder="Contoh: Andi Wijaya">
                </div>
                <div class="form-group">
                    <label for="origin">Asal Kota / Instansi</label>
                    <input type="text" id="origin" required placeholder="Contoh: Jakarta">
                </div>
                <div class="form-group">
                    <label for="photo">URL Foto (Pravatar/Link Image)</label>
                    <input type="url" id="photo" required placeholder="Contoh: https://i.pravatar.cc/150?u=1">
                </div>
                <div class="form-group">
                    <label for="stars">Rating</label>
                    <select id="stars">
                        <option value="5">5 Bintang</option>
                        <option value="4">4 Bintang</option>
                        <option value="3">3 Bintang</option>
                        <option value="2">2 Bintang</option>
                        <option value="1">1 Bintang</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="text">Komentar / Testimoni</label>
                    <textarea id="text" rows="4" required placeholder="Tuliskan testimoni di sini..."></textarea>
                </div>
                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                    <button type="submit" class="btn-admin" style="flex: 1;">Simpan</button>
                    <button type="button" class="btn-admin btn-danger" id="cancel-btn">Batal</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Initial Data (Sourced from index.html)
        let testimonials = [
            {
                name: "Fahril Veraldyka",
                origin: "Bandung",
                text: "Salah satu pengalaman paling unik yang pernah saya dapatkan! Dapat melihat keseharian warga adat dan kelestarian budaya yang tetap terjaga. Tidak lupa terimakasih untuk seluruh pihak yang telah membantu merealisasikan kunjungan saat itu!,  
                photo: "assets/testimonials/foto-Fahril.jpg",
                stars: 5
            },
            {
                name: "Siti Aminah",
                origin: "Bandung",
                text: "Kasepuhan Gelaralam adalah laboratorium budaya yang hidup. Belajar tentang filosofi padi dan cara hidup mandiri pangan dari sini adalah ilmu yang sangat berharga bagi generasi muda.",
                photo: "https://i.pravatar.cc/150?u=2",
                stars: 5
            },
            {
                name: "Budi Santoso",
                origin: "Yogyakarta",
                text: "Sangat terkesan dengan keramahan warga adat. Hidangan nasi baru dari Leuit memiliki rasa yang sangat khas dan nikmat. Wajib dikunjungi bagi pecinta wisata budaya.",
                photo: "https://i.pravatar.cc/150?u=3",
                stars: 5
            }
        ];

        // Elements
        const listEl = document.getElementById('testimonial-list');
        const modal = document.getElementById('modal');
        const form = document.getElementById('testimonial-form');
        const addBtn = document.getElementById('add-btn');
        const cancelBtn = document.getElementById('cancel-btn');
        const generateBtn = document.getElementById('generate-btn');
        const outputContainer = document.getElementById('output-container');
        const outputCode = document.getElementById('output-code');
        const copyBtn = document.getElementById('copy-btn');

        // Functions
        function renderList() {
            listEl.innerHTML = '';
            testimonials.forEach((t, index) => {
                const item = document.createElement('div');
                item.className = 'testimonial-item';
                item.innerHTML = `
                    <div class="item-info">
                        <img src="${t.photo}" alt="${t.name}" class="item-photo">
                        <div>
                            <div class="item-name">${t.name} <span class="badge">${t.stars} â˜…</span></div>
                            <div class="item-text" style="color: #64748b;">${t.origin}</div>
                        </div>
                    </div>
                    <div class="actions">
                        <button class="btn-icon" onclick="editItem(${index})"><i class="fa-solid fa-pen"></i></button>
                        <button class="btn-icon" style="color: #ef4444;" onclick="deleteItem(${index})"><i class="fa-solid fa-trash"></i></button>
                    </div>
                `;
                listEl.appendChild(item);
            });
        }

        function deleteItem(index) {
            if (confirm('Apakah Anda yakin ingin menghapus testimoni ini?')) {
                testimonials.splice(index, 1);
                renderList();
            }
        }

        function editItem(index) {
            const t = testimonials[index];
            document.getElementById('edit-index').value = index;
            document.getElementById('name').value = t.name;
            document.getElementById('origin').value = t.origin;
            document.getElementById('photo').value = t.photo;
            document.getElementById('stars').value = t.stars;
            document.getElementById('text').value = t.text;
            document.getElementById('modal-title').innerText = 'Edit Testimoni';
            modal.classList.add('active');
        }

        // Event Listeners
        addBtn.addEventListener('click', () => {
            form.reset();
            document.getElementById('edit-index').value = "-1";
            document.getElementById('modal-title').innerText = 'Tambah Testimoni';
            modal.classList.add('active');
        });

        cancelBtn.addEventListener('click', () => {
            modal.classList.remove('active');
        });

        form.addEventListener('submit', (e) => {
            e.preventDefault();
            const index = parseInt(document.getElementById('edit-index').value);
            const newData = {
                name: document.getElementById('name').value,
                origin: document.getElementById('origin').value,
                photo: document.getElementById('photo').value,
                stars: parseInt(document.getElementById('stars').value),
                text: document.getElementById('text').value
            };

            if (index === -1) {
                testimonials.push(newData);
            } else {
                testimonials[index] = newData;
            }

            modal.classList.remove('active');
            renderList();
        });

        generateBtn.addEventListener('click', () => {
            const code = JSON.stringify(testimonials, null, 4);
            outputCode.innerText = `const testimonialData = ${code};`;
            outputContainer.style.display = 'block';
        });

        copyBtn.addEventListener('click', () => {
            const text = outputCode.innerText;
            navigator.clipboard.writeText(text).then(() => {
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<i class="fa-solid fa-check"></i> Copied!';
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                }, 2000);
            });
        });

        // Initialize
        renderList();
    </script>
</body>

</html>